# Authentication queries and mutations

query GetCurrentUser {
  getCurrentUser {
    id
    username
    email
    role
    member {
      miembro_id
      numero_socio
      nombre
      apellidos
      correo_electronico
    }
    isActive
    lastLogin
    emailVerified
    emailVerifiedAt
  }
}

mutation Login($input: LoginInput!) {
  login(input: $input) {
    user {
      id
      username
      email
      role
      member {
        miembro_id
        numero_socio
        nombre
        apellidos
        correo_electronico
      }
      isActive
      lastLogin
      emailVerified
      emailVerifiedAt
    }
    accessToken
    refreshToken
    expiresAt
  }
}

mutation Logout {
  logout {
    success
    message
    error
  }
}

mutation RefreshToken($input: RefreshTokenInput!) {
  refreshToken(input: $input) {
    accessToken
    refreshToken
    expiresAt
  }
}

mutation ChangePassword($input: ChangePasswordInput!) {
  changePassword(input: $input) {
    success
    message
    error
  }
}

mutation SendVerificationEmail {
  sendVerificationEmail {
    success
    message
    error
  }
}

mutation VerifyEmail($token: String!) {
  verifyEmail(token: $token) {
    success
    message
    error
  }
}

mutation ResendVerificationEmail($email: String!) {
  resendVerificationEmail(email: $email) {
    success
    message
    error
  }
}

mutation RequestPasswordReset($email: String!) {
  requestPasswordReset(email: $email) {
    success
    message
    error
  }
}

mutation ResetPasswordWithToken($token: String!, $newPassword: String!) {
  resetPasswordWithToken(token: $token, newPassword: $newPassword) {
    success
    message
    error
  }
}
