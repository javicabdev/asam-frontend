# CashFlow queries and mutations

# Fragment para datos de transacción
fragment CashFlowTransactionFields on CashFlow {
  id
  date
  operation_type
  amount
  detail
  created_at
  member {
    miembro_id
    numero_socio
    nombre
    apellidos
  }
  payment {
    id
  }
}

# Query: Listar transacciones con filtros y paginación
query GetCashFlows($filter: TransactionFilter) {
  getTransactions(filter: $filter) {
    nodes {
      ...CashFlowTransactionFields
    }
    pageInfo {
      hasNextPage
      hasPreviousPage
      totalCount
    }
  }
}

# Query: Balance actual
query GetCashFlowBalance {
  cashFlowBalance {
    totalIncome
    totalExpenses
    currentBalance
  }
}

# Query: Una transacción específica
query GetCashFlow($id: ID!) {
  getCashFlow(id: $id) {
    ...CashFlowTransactionFields
  }
}

# Mutation: Crear transacción
mutation CreateCashFlow($input: CreateCashFlowInput!) {
  createCashFlow(input: $input) {
    ...CashFlowTransactionFields
  }
}

# Mutation: Actualizar transacción
mutation UpdateCashFlow($id: ID!, $input: UpdateCashFlowInput!) {
  updateCashFlow(id: $id, input: $input) {
    ...CashFlowTransactionFields
  }
}

# Mutation: Eliminar transacción
mutation DeleteCashFlow($id: ID!) {
  deleteCashFlow(id: $id) {
    success
    message
  }
}

# Legacy mutations (mantener por compatibilidad)
mutation RegisterTransaction($input: TransactionInput!) {
  registerTransaction(input: $input) {
    id
    amount
    date
    operation_type
    detail
    member {
      miembro_id
      numero_socio
      nombre
      apellidos
      tipo_membresia
    }
    payment {
      id
      amount
      payment_date
      status
      payment_method
    }
  }
}

mutation UpdateTransaction($id: ID!, $input: TransactionInput!) {
  updateTransaction(id: $id, input: $input) {
    id
    amount
    date
    operation_type
    detail
    member {
      miembro_id
      numero_socio
      nombre
      apellidos
      tipo_membresia
    }
    payment {
      id
      amount
      payment_date
      status
      payment_method
    }
  }
}

mutation AdjustBalance($amount: Float!, $reason: String!) {
  adjustBalance(amount: $amount, reason: $reason) {
    success
    message
    error
  }
}
